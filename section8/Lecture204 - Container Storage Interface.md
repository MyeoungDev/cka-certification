# Lecture 204 - Container Storage Interface

## Container Storage Interface

## 컨테이너 오케스트레이션의 진화

- 예전의 쿠버네티스는 컨테이너 런타임 엔진으로 Docker 에만 의존했다.
- Docker 와의 인터페이싱을 위한 모든 코드는 쿠버네티스 소스 코드 내에 존재했다.
- 그러나, `Rocket` 이나 `CRI-O` 와 같은 대체 컨테이너 런타임이 등장하면서, 쿠버네티스의 핵심 코드베이스를 변경하지 않고도 여러 런타임을 지원해야 할 필요성이 생겼다.
- 이를 위해 다양한 컨테이너 런타임과 원활하게 통신 할 수 있게 하는 Container Runtime Interface CRI 가 개발되었다.
- 이와 유사하게, 다양한 네트워킹 솔루션 통합을위해 Container Networking Interface CNI 가 도입되었다.
- CNI 를 통해 Network Provider 는 표준화된 사양을 준수하는 플러그인을 구축하여, 쿠버네티스 환경 내에서 원활한 동작을 보장할 수 있다.

## CSI의 역할

- CSI 는 표준화 원칙을 스토리지 도메인으로 확장하여 여러 스토리지 시스템을 지원할 수 있게 한다.
- Container Storage Interface(CSI) 를 통해 개발자는 다양한 스토리지 시스템에 맞는 맞춤형 드라이버를 개발할 수 있다.
- CSI 표준을 구현하는 모든 컨테이너 오케스트레이션 도구는 CSI 플러그인을 지원하는 거의 모든 스토리지 공급업체와 호환된다.
- CSI는 정의된 RPC(Remote Procedure Call) 를 통해 통신을 표준화함으로써 개발자가 다양한 스토리지 공급업체를 컨테이너화된 환경에 최소한의 마찰로 통합할 수 있도록 지원한다.

## CSI 작동 방식

- Persistent Storage 가 필요한 포드가 생성되면 컨테이너 오케스트레이터(예: 쿠버네티스)는 CSI 표준에 정의된 볼륨 생성 RPC을 호출한다.
- 볼륨 생성 RPC 호출에는 볼륨 이름 및 기타 매개변수와 같은 중요한 정보가 포함된다.
- Storage Driver는 연결된 스토리지 배열에 새 볼륨을 프로비저닝하여 요청을 처리하고 결과를 오케스트레이터에 반환한다.
- 볼륨이 더 이상 필요하지 않을 경우 오케스트레이터는 볼륨 삭제 RPC 를 실행한다.
- Storage Driver 는  지정된 볼륨을 스토리지 시스템에서 제거한 후 응답한다.
- CSI 사양은 이러한 작업에 필요한 매개변수, 예상 응답 및 오류 코드를 명시하여 다양한 스토리지 솔루션 간의 일관성과 상호 운용성을 보장한다.